<div class="co-sysevent-stream">
  <div class="co-sysevent-stream__totals" ng-bind="getTotalMessage()"></div>

  <div class="co-sysevent-stream__timeline" ng-class="{'co-sysevent-stream__timeline--empty': !messages.length || !filteredMessages.length}">
    <co-toggle-play class="co-sysevent-stream__timeline__btn" active="btnActive" on-toggle="toggleStream(active)"></co-toggle-play>
    <div class="co-sysevent-stream__timeline__btn-text">
      <span ng-show="wsConnected() && ws.isPaused()">
        Event stream is paused.
        <a href="#" ng-click="toggleStream(true)" ng-show="ws.bufferSize()" ng-bind-template="Show {{ws.bufferSize()}} new events."></a>
      </span>
      <span ng-show="wsConnected() && !ws.isPaused()">Streaming events...</span>
      <span class="co-sysevent-stream__connection-error" ng-show="wsError()">Error connecting to event stream</span>
      <span class="" ng-show="wsLoading()">Loading events...</span>
    </div>
    <div class="co-sysevent-stream__timeline__end-message">
      There are no events before <span ng-bind="oldestTimestamp | customDate"></span>
    </div>
  </div>

  <cos-status-box ng-show="wsError()">
    <div class="cos-error-title">Error Loading Events</div>
    <div class="cos-text-center">An error occurred during event retrieval. Attempting to reconnect...</div>
  </cos-status-box>

  <div class="co-sysevent" ng-init="updateOldest(m.object.lastTimestamp, $last)"
        ng-repeat="m in filteredMessages=(messages | sysevents:eventsFilter | orderBy:'object.lastTimestamp':true | limitTo:maxMessages ) track by m.object.metadata.uid">
    <div class="co-sysevent__icon-box">
      <co-sysevent-icon kind="{{m.object.involvedObject.kind}}" reason="{{m.object.reason}}"></co-sysevent-icon>
      <div class="co-sysevent__icon-line"></div>
    </div>
    <div class="co-sysevent__main-box">
      <co-resource-link
          kind="{{m.object.involvedObject.kind}}"
          namespace="{{m.object.involvedObject.namespace}}"
          name="{{m.object.involvedObject.name}}"
          uid="{{m.object.involvedObject.uid}}">
      </co-resource-link>
      <div class="co-sysevent__main-message" ng-bind="m.object.message"></div>
    </div>
    <div class="co-sysevent__meta-box">
      <div ng-bind="m.object.lastTimestamp | customDate"></div>
      <small class="co-sysevent__meta-source">
        Generated from <span ng-bind="m.object.source.component"></span>
        <span ng-if="m.object.source.component == 'kubelet'">on <a ng-href="/nodes/{{m.object.source.host}}" ng-bind="m.object.source.host"></a></span>
      </small>
    </div>
  </div>

  <cos-status-box ng-show="wsConnected() && filteredMessages.length == 0 && messages.length" class="co-sysevent-stream__status-box-empty">
    <div>No Matching Events</div>
    <div class="cos-text-center" ng-bind-template="{{messages.length}} events exist, but none match the current filter"></div>
  </cos-status-box>

  <cos-status-box ng-show="wsConnected() && messages.length == 0 && ws.bufferSize() == 0" class="co-sysevent-stream__status-box-empty">
    <div>No Events</div>
    <div class="cos-text-center">No matching events found in the system.</div>
  </cos-status-box>

  <co-loader ng-show="wsLoading()"></co-loader>

</div>
