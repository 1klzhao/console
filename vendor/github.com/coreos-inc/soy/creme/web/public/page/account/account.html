<div class="tec-p-account">
  <h1 class="cos-page-title">Account Information</h1>

  <div class="row">
    <div class="col-md-12 col-sm-12">
      <div class="cos-pane">
        <div class="tec-pane-section--spacious">
          <h3 class="tec-small-panel-header">Account Details</h3>
        </div>
        <div ng-if="!vm.loadState.account.loaded" class="tec-pane-section">
          <cos-loader></cos-loader>
        </div>
        <div ng-if="vm.loadState.account.failed" class="tec-pane-section text-center">
          <cos-status-box>
            <div class="cos-error-title">Error loading company details</div>
            <div>Try reloading the page</div>
          </cos-status-box>
        </div>
        <div ng-if="vm.account && !vm.loadState.account.failed" class="tec-pane-section">
          <div class="row">
            <div class="col-sm-4 tec-margin-bottom">
              <dl>
                <dt>Account Number</dt>
                <dd class="text-small" ng-bind="vm.account.id"></dd>
                <dt>Created Date</dt>
                <dd class="text-small" ng-bind="vm.account.createdAt | apiDate"></dd>
              </dl>
            </div>
            <div class="col-sm-4 tec-xs-margin-bottom">
              <dl>
                <dt>Contact Info</dt>
                <dd>
                  <tec-contact-view profile="vm.account.profile"></tec-contact-view>
                </dd>
              </dl>
              <a ng-if="canModifyAccount(vm.account.id) && vm.account && !vm.loadState.account.failed" class="tec-edit-link" ng-click="vm.openProfileModal()">Edit</a>
            </div>
            <div ng-if="!vm.isAddressEmpty(vm.mailingAddress)" class="col-sm-4 tec-xs-margin-bottom">
              <dl>
                <dt>Mailing Address</dt>
                <dd>
                  <tec-address-view address="vm.mailingAddress"></tec-address-view>
                </dd>
              </dl>
              <a ng-if="canModifyAccount(vm.account.id)" class="tec-edit-link" ng-click="vm.openMailingAddressModal()">Edit</a>
            </div>
            <div ng-if="vm.isAddressEmpty(vm.mailingAddress)">
              <dl>
                <dt>Mailing Address</dt>
                <dd>
                  No mailing address on file.
                </dd>
              </dl>
              <a ng-if="canModifyAccount(vm.account.id)" class="tec-edit-link" ng-click="vm.openMailingAddressModal()">Add Address</a>
            </div>

          </div>
        </div>
      </div><!-- pane -->
    </div><!-- col -->
  </div><!-- .row -->

  <div class="row">
    <div class="col-md-12 col-sm-12">
      <div class="cos-pane">
        <div class="tec-pane-section--spacious">
          <h3 class="tec-small-panel-header">Users</h3>
        </div>
        <div ng-if="!vm.loadState.users.loaded" class="tec-pane-section">
          <cos-loader></cos-loader>
        </div>
        <div ng-if="vm.loadState.users.failed" class="tec-pane-section text-center">
          <cos-status-box>
            <div class="cos-error-title">Error loading users</div>
            <div>Try reloading the page</div>
          </cos-status-box>
        </div>
        <div ng-if="vm.users && !vm.loadState.users.failed" class="tec-pane-section">
          <div class="tec-margin-bottom">
            <button ng-if="canModifyAccount(vm.account.id)" ng-click="vm.openInviteUserModal()" class="btn btn-primary">Invite New User</button>
          </div>

          <table class="tec-simple-table tec-simple-table--medium-text">
            <thead>
              <tr>
                <th class="tec-simple-table__cog"></th>
                <th>Email Address</th>
                <th>Role</th>
                <th>Invitation Status</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="u in vm.users | orderBy:'email'">
                <td class="tec-simple-table__cog">
                  <div ng-if="vm.showUserCog(u)" cos-dropdown="left">
                    <span class="cos-dropdown__toggle ci-cog cos-dropdown__cog"></span>
                    <ul class="cos-dropdown__menu">
                      <li><a ng-click="vm.openUpdateUserModal(u)">Change Role...</a></li>
                      <li><a ng-click="vm.openRevokeUserModal(u)">Revoke Access...</a></li>
                    </ul>
                  </div>
                </td>
                <td>
                  <a ng-href="mailto:{{u.email}}" ng-bind="u.email"></a>
                </td>
                <td ng-bind="u | userRole"></td>
                <td ng-bind="u | userInviteStatus"></td>
              </tr>
            </tbody>
          </table>

        </div>
      </div><!-- pane -->
    </div><!-- col -->
  </div><!-- .row -->


  <div ng-if="canModifyAccount(vm.account.id)" class="row">
    <div class="col-md-12 col-sm-12">
      <div class="cos-pane">
        <div class="tec-pane-section--spacious">
          <h3 class="tec-small-panel-header">Account Termination</h3>
        </div>
        <div class="tec-pane-section">
          <div class="row">
            <div class="col-sm-12">
              <div class="tec-margin-bottom">
                In order to terminate your account you must:
                <ol>
                  <li>Manually cancel any active products.</li>
                  <li>Ensure all outstanding invoices are paid in full.</li>
                </ol>
              </div>
              <button ng-click="vm.openTerminateModal(vm.account)" class="btn btn-default">Terminate Account</button>
            </div>
          </div>
        </div>
      </div><!-- pane -->
    </div><!-- col -->
  </div><!-- .row -->

</div>
