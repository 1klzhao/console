<div class="tec-p-products">
  <h1 class="cos-page-title">Overview</h1>

  <div class="row">
    <div class="col-sm-12">


      <div class="cos-pane">
        <div class="cos-pane__content">
          <h3 class="tec-small-panel-header">Your Products</h3>
        </div>
        <div ng-if="!vm.loadState.subs.loaded" class="tec-pane-section">
          <cos-loader></cos-loader>
        </div>
        <div ng-if="vm.loadState.subs.failed" class="tec-pane-section text-center">
          <cos-status-box>
            <div class="cos-error-title">Error loading your products</div>
            <div>Try reloading the page</div>
          </cos-status-box>
        </div>
        <div ng-if="vm.loadState.subs.loaded && !vm.subscriptions.children.length && !vm.loadState.subs.failed" class="tec-pane-section">
          <div class="text-center tec-empty-state">
            <h3 class="tec-empty-state__title">You haven't purchased any products yet</h3>
            <div class="text-muted text-small">
              Available products listed below. Product questions? sales@tectonic.com | +1 (800) 774-3507
            </div>
          </div>
        </div>
        <div ng-if="vm.subscriptions.children.length && !vm.loadState.subs.failed" class="tec-pane-section">
          <table class="tec-simple-table tec-simple-table--top-align">
            <thead>
              <tr>
                <th></th>
                <th>Name</th>
                <th>Plan</th>
                <th>Purchase Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="s in vm.subscriptions.children track by s.id">
                <td>
                  <div ng-if="vm.canTakeSubscriptionAction(s)" cos-dropdown="left">
                    <span class="cos-dropdown__toggle ci-cog cos-dropdown__cog"></span>
                    <ul class="cos-dropdown__menu">
                      <li ng-if="vm.canUncancel(s)"><a ng-click="vm.openUncancelModal(s)">Reactivate Product...</a></li>
                      <li ng-if="vm.canCancel(s)"><a ng-click="vm.openCancelModal(s)">Deactivate Product...</a></li>
                    </ul>
                  </div>
                </td>
                <td>
                  <div class="tec-product-title" ng-bind="s.product.publicName"></div>
                  <a ng-if="s.product.quickstartLink" ng-href="{{s.product.quickstartLink}}" target="_blank">View Documentation</a>
                </td>
                <td>
                  <div ng-bind="s.ratePlan.publicName"></div>
                  <tec-entitlement-list component-values="s.pricingComponentValues"></tec-entitlement-list>
                </td>
                <td>
                  <span ng-if="!vm.isDateEmpty(s.contractStart)" ng-bind="s.contractStart | apiDate"></span>
                  <span ng-if="vm.isDateEmpty(s.contractStart)" ng-bind="s.initialPeriodStart | apiDate"></span>
                </td>
                <td ng-class="{'tec-status--ok': s.stateSeverity == 2, 'tec-status--bad': s.stateSeverity == 4}"
                    ng-bind="s.stateDescription"></td>
              </tr>
            </tbody>
          </table>
        </div><!-- /.tec-pane-section -->
      </div><!-- /.cos-pane -->

    </div><!-- /col -->
  </div><!-- /row -->


  <div class="row">
    <div class="col-sm-6">

      <div class="cos-pane">
        <div class="cos-pane__content">
          <h3 class="tec-small-panel-header">Available Products</h3>
        </div>
        <div ng-if="!vm.loadState.products.loaded" class="tec-pane-section">
          <cos-loader></cos-loader>
        </div>
        <div ng-if="vm.loadState.products.failed" class="tec-pane-section text-center">
          <cos-status-box>
            <div class="cos-error-title">Error loading products</div>
            <div>Try reloading the page</div>
          </cos-status-box>
        </div>
        <div ng-if="vm.products && !vm.loadState.products.failed" class="tec-pane-section">
          <table class="tec-simple-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="p in vm.products | orderBy:'order' track by p.id" ng-init="plinks = vm.productLinks(p)">
                <td class="tec-product-title" ng-bind="p.publicName"></td>
                <td>
                  <div><a ng-href="{{plinks.link}}" ng-bind="plinks.text"></a></div>
                  <div><a ng-if="plinks.externalLink" ng-href="{{plinks.externalLink}}" target="_blank">Learn More</a></div>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="tec-product-list-footer">
            Questions? <a href="mailto:sales@tectonic.com">sales@tectonic.com</a> +1 (800) 774-3507
          </div>
        </div><!-- /.tec-pane-section -->
      </div><!-- /.cos-pane -->

    </div><!-- /col -->

    <div class="col-sm-6">

      <div class="cos-pane">
        <div class="cos-pane__content">
          <h3 class="tec-small-panel-header">Account Assets</h3>
        </div>
        <div ng-if="!vm.loadState.assets.loaded && !vm.loadState.assets.failed" class="tec-pane-section">
          <cos-loader></cos-loader>
        </div>
        <div ng-if="vm.loadState.assets.failed" class="tec-pane-section text-center">
          <cos-status-box>
            <div class="cos-error-title">Error loading license</div>
            <div>Try reloading the page</div>
          </cos-status-box>
        </div>
        <div ng-if="vm.loadState.assets.loaded && !vm.loadState.assets.failed" class="tec-pane-section">
          <div ng-if="vm.assets && !vm.loadState.assets.failed">
            <tec-asset-view asset="vm.assets.license"></tec-asset-view>
          </div>
          <div ng-if="!vm.assets && !vm.loadState.assets.failed && vm.loadState.assets.loaded" class="text-small text-muted">
            Each tectonic account will have one license. It will appear here.
          </div>
        </div><!-- /.tec-pane-section -->
        <div class="tec-separator"></div>
        <div ng-if="vm.loadState.assets.loaded && !vm.loadState.assets.failed" class="tec-pane-section--spacious">
          <div ng-if="vm.assets && !vm.loadState.assets.failed">
            <tec-asset-view asset="vm.assets.quayCredentials"></tec-asset-view>
          </div>
          <div ng-if="!vm.assets && !vm.loadState.assets.failed && vm.loadState.assets.loaded" class="text-small text-muted">
            Each tectonic account will have one pull secret. It will appear here.
          </div>
        </div><!-- /.tec-pane-section -->
      </div><!-- /.cos-pane -->

    </div><!-- /col -->

  </div>
</div>
